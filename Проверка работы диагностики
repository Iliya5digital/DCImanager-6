Вы можете посмотреть настройки и информацию о работе сервисов, участвующих в процессе диагностики. Часть этих сервисов находится на сервере с DCImanager 6, часть — на локации.

Подготовка шаблона диагностикиLink to Подготовка шаблона диагностики
Лог-файлы подготовки шаблона вы можете посмотреть на сервере с DCImanager 6 в контейнере dci_back:

/var/log/dci_1_writer.log — операции диагностики записываются в этот файл с идентификатором operation_diag;
/var/log/dci_operationctl.log — информация о предварительной настройке сервисов диагностики.
Для перехода в контейнер подключитесь к серверу с DCImanager 6 по SSH и выполните команду:

docker exec -it dci_back sh
DHCP-серверLink to DHCP-сервер
DHCP-сервер находится на локации в докер-контейнере kea_dhcp. Информация о его работе записывается в лог-файл /var/log/kea-dhcp4.log внутри контейнера. Конфигурационный файл DHСP-сервера /etc/kea/kea-dhcp4.conf доступен как на локации, так и в контейнере. Уровень логирования задаётся параметром severity в секции loggers конфигурационного файла:

NONE — журналирование не ведётся;
FATAL — информация о событиях, критических для работы сервера;
ERROR — информация об ошибках, возникающих в работе сервера;
WARN — информация о нетипичных событиях в работе сервера;
INFO — информация обо всех событиях. Этот уровень установлен по умолчанию;
DEBUG — информация, необходимая для отладки. Вы можете установить требуемую подробность журналирования на этом уровне в параметре debuglevel: 0 — минимальное значение, 99 — максимальное.


Пример настройки журналирования DHCP-сервера

"loggers": [
      {
        "severity": "DEBUG",        
        "debuglevel": 99,
        "name": "kea-dhcp4",
        "output_options": [ { "output": "/var/log/kea-dhcp4.log" } ]
      }
    ]
NFS-серверLink to NFS-сервер
NFS-сервер находится на локации. Список директорий для передачи по NFS хранится в файле /opt/ispsystem/dci/etc/exports. Этот файл монтируется в директорию /etc/ контейнера nfsd. Формат файла соответствует стандартному конфигурационному файлу NFS.

Чтобы посмотреть лог-файл NFS-сервера, подключитесь к локации по SSH и выполните команду:

docker logs nfsd
HTTP-серверLink to HTTP-сервер
HTTP-сервер находится на локации в контейнере lweb. Конфигурационный файл HTTP-сервера — /etc/nginx/conf.d/dci-nginx.conf.

В лог-файл HTTP-cервера записываются запросы от iPXE-загрузчика и шаблона диагностики на локацию. Чтобы посмотреть лог-файл, подключитесь к локации по SSH и выполните команду:

docker logs lweb
Запросы от HTTP-севера передаются на обработку скрипту /home/scripts/dci-fcgiwrap.py в контейнере lweb. Журнал работы скрипта сохраняется в файле /var/log/fcgiwrap.log. Для просмотра журнала перейдите в контейнер lweb:

docker exec -it lweb sh
TFTP-серверLink to TFTP-сервер
TFTP-сервер находится на локации. Файлы для передачи на диагностируемый сервер по TFTP находятся в директории /var/lib/tftpboot/srv_id/, где srv_id — id диагностируемого сервера.

